{% extends "template.htm" %}
{% block contents %}   
  <ul class="tabs">
    <li class="active"><a href="#">Files</a></li>
    <li><a href="/{{owner.getNickname()}}/{{repository.getName()}}/commits/master">Commits</a></li>
    <li><a href="#">Branches</a></li>
    <li><a href="/{{owner.getNickname()}}/{{repository.getName()}}/tags">Tags</a></li>
    <li><a href="/{{owner.getNickname()}}/{{repository.getName()}}/issues">Issues ({{issue_count}})</a></li>
  </ul>
  
  {% if tags %}
  <div>{% for tag in tags %}<a href="/{{owner.getNickname()}}/{{repository.getName()}}/commit/{{tag.oid}}">{{tag.name}}</a> | {% endfor %}</div>
  {% endif %}  

  {% if user %}
  <div><span class="btn secondary">ssh</span><input type="text" value="git@githq.org:{{owner.getNickname()}}/{{repository.getName()}}.git" style="width:20em;"/></div>
  {% endif %}
  
  {% if commit %}
  
  <div class="commit">
    <p>{{commit.getMessage()}}</p>
    <div>
    <img src="https://secure.gravatar.com/avatar/{{commit.getAuthor().email|md5}}?s=20">{{commit.getAuthor().name}}<br />
    {{commit.getAuthor().time.format('Y-m-d H:i:s')}}</div>
  </div>


  <table class="zebra-striped">
  	<tr>
  		<th>name</th><th>age</th><th>message</th>
  	</tr>
  	{% if parent_dir %}
  	<tr>
	<td><img src="/assets/dir.png" /><a href="/{{owner.getNickname()}}/{{repository.getName()}}/tree/master/{{parent_dir}}">..</a></td>
	<td></td>
	<td></td>
	</tr>
	{% endif %}
	{% for entry in tree %}
	<tr>
	{% if entry.isBlob() %}
	<td><img src="/assets/txt.png" /><a href="/{{owner.getNickname()}}/{{repository.getName()}}/blob/master/{{current_path}}{{entry.name}}">{{entry.name}}</a></td>
	<td></td>
	<td></td>
	{% else %}
	<td><img src="/assets/dir.png" /><a href="/{{owner.getNickname()}}/{{repository.getName()}}/tree/master/{{current_path}}{{entry.name}}">{{entry.name}}</a></td>
	<td></td>
	<td></td>
	{% endif %}
	</tr>
	{% endfor %}
  </table>

  {% if data %}
  <div>
  <h2>{{path}}</h2>
  <div style="text-align:right"><a href="/{{owner.getNickname()}}/{{repository.getName()}}/blame/master/{{path}}">blame</a></div>
  <div style="text-align:right"><a href="/{{owner.getNickname()}}/{{repository.getName()}}/commits/master/{{path}}">history</a></div>
  <div class="highlight" style="white-space:nowrap;font-family:'Bitstream Vera Sans Mono','Courier',monospace;">{{data|raw}}</div>
  </div>
  {% endif %}
  
  {% else %}
  
<h3>Global setup:Set up git</h3>
<pre>
  git config --global user.name "{{user.getNickname()}}"
  git config --global user.email {{user.getEmail()}}
</pre>      
<h3>Next steps:</h3>
<pre>
  mkdir {{repository.getName()}}
  cd {{repository.getName()}}
  git init
  touch README
  git add README
  git commit -m 'first commit'
  git remote add origin git@githq.org:{{user.getNickname()}}/{{repository.getName()}}.git
  git push -u origin master
</pre>
      
<h3>Existing Git Repo?  cd existing_git_repo</h3>
<pre>
  git remote add origin git@githq.org:{{user.getNickname()}}/{{repository.getName()}}.git
  git push -u origin master
</pre>
  {% endif %}

 {% endblock %}